function init(){"use strict";console.log("Boel game starting at "+new Date),console.log("TweenJS version "+createjs.TweenJS.version),console.log("EaselJS version "+createjs.EaselJS.version),setTimeout(printDebug,5e3,createjs.TweenJS.version+" "+createjs.EaselJS.version),canvas=document.getElementById("myCanvas"),changeBackground(splashScreenBackgroundColor),minBounceDistance=Math.floor(1.5*Math.sqrt(canvasWidth*canvasWidth+canvasHeight*canvasHeight)),loadedFiles=0,nowMillis=0,nextSmash=-1,nextRandomCheck=-1,pieceNumberToSmash=-1,nextBallTime=-1,selectedCharacterIndex=-1,selectedName="",stage=new createjs.Stage(canvas),stage.name="The Stage",createjs.Touch.enable(stage),addProgressBar(),addDebugText();var e=[{id:"boelgets1",src:"assets/boelgets1.mp3"},{id:"boelgets2",src:"assets/boelgets2.mp3"},{id:"boelgets3",src:"assets/boelgets3.mp3"},{id:"boelgets4",src:"assets/boelgets4.mp3"},{id:"boelgets5",src:"assets/boelgets5.mp3"},{id:"boelgets6",src:"assets/boelgets6.mp3"},{id:"dadgets1",src:"assets/dadgets1.mp3"},{id:"dadgets2",src:"assets/dadgets2.mp3"},{id:"dadgets3",src:"assets/dadgets3.mp3"},{id:"dadgets4",src:"assets/dadgets4.mp3"},{id:"dadgets5",src:"assets/dadgets5.mp3"},{id:"dadgets6",src:"assets/dadgets6.mp3"},{id:"doggets1",src:"assets/doggets1.mp3"},{id:"doggets2",src:"assets/doggets2.mp3"},{id:"doggets3",src:"assets/doggets3.mp3"},{id:"doggets4",src:"assets/doggets4.mp3"},{id:"doggets5",src:"assets/doggets5.mp3"},{id:"doggets6",src:"assets/doggets6.mp3"},{id:"granddadgets1",src:"assets/granddadgets1.mp3"},{id:"granddadgets2",src:"assets/granddadgets2.mp3"},{id:"granddadgets3",src:"assets/granddadgets3.mp3"},{id:"granddadgets4",src:"assets/granddadgets4.mp3"},{id:"granddadgets5",src:"assets/granddadgets5.mp3"},{id:"granddadgets6",src:"assets/granddadgets6.mp3"},{id:"mumgets1",src:"assets/mumgets1.mp3"},{id:"mumgets2",src:"assets/mumgets2.mp3"},{id:"mumgets3",src:"assets/mumgets3.mp3"},{id:"mumgets4",src:"assets/mumgets4.mp3"},{id:"mumgets5",src:"assets/mumgets5.mp3"},{id:"mumgets6",src:"assets/mumgets6.mp3"},{id:"toregets1",src:"assets/toregets1.mp3"},{id:"toregets2",src:"assets/toregets2.mp3"},{id:"toregets3",src:"assets/toregets3.mp3"},{id:"toregets4",src:"assets/toregets4.mp3"},{id:"toregets5",src:"assets/toregets5.mp3"},{id:"toregets6",src:"assets/toregets6.mp3"},{id:"tada",src:"assets/tada.mp3"},{id:"yesblue",src:"assets/yesblue.mp3"},{id:"yesgreen",src:"assets/yesgreen.mp3"},{id:"yesred",src:"assets/yesred.mp3"},{id:"yesyellow",src:"assets/yesyellow.mp3"},{id:"thatwasblue",src:"assets/thatwasblue.mp3"},{id:"thatwasgreen",src:"assets/thatwasgreen.mp3"},{id:"thatwasred",src:"assets/thatwasred.mp3"},{id:"thatwasyellow",src:"assets/thatwasyellow.mp3"},{id:"cakebounce",src:"assets/cakebounce.mp3"},{id:"silence1000",src:"assets/silence1000.mp3"},{id:"silence300",src:"assets/silence300.mp3"},{id:"whereblue",src:"assets/whereblue.mp3"},{id:"wheregreen",src:"assets/wheregreen.mp3"},{id:"wherered",src:"assets/wherered.mp3"},{id:"whereyellow",src:"assets/whereyellow.mp3"},{id:"boeltap",src:"assets/boeltap.mp3"},{id:"boelwhereis",src:"assets/boelwhereis.mp3"},{id:"boelwouldlike",src:"assets/boelwouldlike.mp3"},{id:"dadtap",src:"assets/dadtap.mp3"},{id:"dadwhereis",src:"assets/dadwhereis.mp3"},{id:"dadwouldlike",src:"assets/dadwouldlike.mp3"},{id:"dogtap",src:"assets/dogtap.mp3"},{id:"dogwhereis",src:"assets/dogwhereis.mp3"},{id:"dogwouldlike",src:"assets/dogwouldlike.mp3"},{id:"granddadtap",src:"assets/granddadtap.mp3"},{id:"granddadwhereis",src:"assets/granddadwhereis.mp3"},{id:"granddadwouldlike",src:"assets/granddadwouldlike.mp3"},{id:"mumtap",src:"assets/mumtap.mp3"},{id:"mumwhereis",src:"assets/mumwhereis.mp3"},{id:"mumwouldlike",src:"assets/mumwouldlike.mp3"},{id:"toretap",src:"assets/toretap.mp3"},{id:"torewhereis",src:"assets/torewhereis.mp3"},{id:"torewouldlike",src:"assets/torewouldlike.mp3"},{id:"boelbut",src:"assets/boelbut.mp3"},{id:"torebut",src:"assets/torebut.mp3"},{id:"granddadbut",src:"assets/granddadbut.mp3"},{id:"dogbut",src:"assets/dogbut.mp3"},{id:"mumbut",src:"assets/mumbut.mp3"},{id:"dadbut",src:"assets/dadbut.mp3"},{id:"ballhelp1",src:"assets/ballhelp1.mp3"},{id:"ballhelp2",src:"assets/ballhelp2.mp3"},{id:"ballhelp3",src:"assets/ballhelp3.mp3"},{id:"generalhelp1",src:"assets/generalhelp1.mp3"},{id:"generalhelp2",src:"assets/generalhelp2.mp3"},{id:"generalhelp3",src:"assets/generalhelp3.mp3"},{id:"generalhelp4",src:"assets/generalhelp4.mp3"},{id:"cakehelp1",src:"assets/cakehelp1.mp3"},{id:"cakehelp2",src:"assets/cakehelp2.mp3"},{id:"cakehelp3",src:"assets/cakehelp3.mp3"},{id:"cakehelp4",src:"assets/cakehelp4.mp3"},{id:"clotheshelp1",src:"assets/clotheshelp1.mp3"},{id:"clotheshelp2",src:"assets/clotheshelp2.mp3"},{id:"clotheshelp3",src:"assets/clotheshelp3.mp3"},{id:"clotheshelp4",src:"assets/clotheshelp4.mp3"},{id:"clotheshelp5",src:"assets/clotheshelp5.mp3"},{id:"yes",src:"assets/yes.mp3"}],a=[{id:"piece1",src:"assets/piece1.png"},{id:"piece2",src:"assets/piece2.png"},{id:"piece3",src:"assets/piece3.png"},{id:"piece4",src:"assets/piece4.png"},{id:"piece5",src:"assets/piece5.png"},{id:"piece6",src:"assets/piece6.png"},{id:"smashedPiece1",src:"assets/smashedpiece1.png"},{id:"smashedPiece2",src:"assets/smashedpiece2.png"},{id:"smashedPiece3",src:"assets/smashedpiece3.png"},{id:"smashedPiece4",src:"assets/smashedpiece4.png"},{id:"smashedPiece5",src:"assets/smashedpiece5.png"},{id:"smashedPiece6",src:"assets/smashedpiece6.png"},{id:"cake0",src:"assets/cake0.png"},{id:"cake1",src:"assets/cake1.png"},{id:"cake2",src:"assets/cake2.png"},{id:"cake3",src:"assets/cake3.png"},{id:"cake4",src:"assets/cake4.png"},{id:"cake5",src:"assets/cake5.png"},{id:"cake6",src:"assets/cake6.png"}],t=[{id:"boelToreSplash",src:"assets/boeltoresplash.png"},{id:"menuBall",src:"assets/menuball.png"},{id:"menuCake",src:"assets/menucake.png"},{id:"menuClothes",src:"assets/menuclothes.png"},{id:"menuHelp",src:"assets/menuhelp.png"},{id:"backButton",src:"assets/backbutton.png"},{id:"line",src:"assets/line.png"},{id:"shirtLine",src:"assets/shirtline.png"},{id:"shirtWear",src:"assets/shirtwear.png"},{id:"trousersLine",src:"assets/trousersline.png"},{id:"trousersWear",src:"assets/trouserswear.png"},{id:"sockLeftLine",src:"assets/sockleftline.png"},{id:"sockLeftWear",src:"assets/sockleftwear.png"},{id:"sockRightLine",src:"assets/sockrightline.png"},{id:"sockRightWear",src:"assets/sockrightwear.png"},{id:"tore",src:"assets/tore.png"},{id:"toreSad",src:"assets/toresad.png"},{id:"star",src:"assets/star.png"},{id:"blueBall",src:"assets/blueball.png"},{id:"redBall",src:"assets/redball.png"},{id:"yellowBall",src:"assets/yellowball.png"},{id:"greenBall",src:"assets/greenball.png"},{id:"cakeBall",src:"assets/cake_ball.png"}];numberOfCakePieces=6;var s,r=[];for(s=0;numberOfCakePieces>=s;s+=1)r.push({id:s+"",src:"assets/"+s+".png"});var l=[{id:"tableMom",src:"assets/tablemom.png"},{id:"tableMomSad",src:"assets/tablemomsad.png"},{id:"tableGrandDad",src:"assets/tablegranddad.png"},{id:"tableGrandDadSad",src:"assets/tablegranddadsad.png"},{id:"tableBoel",src:"assets/tableboel.png"},{id:"tableBoelSad",src:"assets/tableboelsad.png"},{id:"tableDad",src:"assets/tabledad.png"},{id:"tableDadSad",src:"assets/tabledadsad.png"},{id:"tableTore",src:"assets/tabletore.png"},{id:"tableToreSad",src:"assets/tabletoresad.png"},{id:"tableTable",src:"assets/tabletable.png"},{id:"tableMomHand",src:"assets/tablemomhand.png"},{id:"tableDadHand",src:"assets/tabledadhand.png"},{id:"tableToreHand",src:"assets/tabletorehand.png"},{id:"tableDog",src:"assets/tabledog.png"},{id:"tableDogSad",src:"assets/tabledogsad.png"},{id:"tableBoelHand",src:"assets/tableboelhand.png"},{id:"tableGrandDadHand",src:"assets/tablegranddadhand.png"}],n=t.concat(a,r,l,e);queue=new createjs.LoadQueue(!1),createjs.Sound.alternateExtensions=["ogg"],queue.installPlugin(createjs.Sound),queue.addEventListener("complete",handleComplete),queue.addEventListener("error",handleFileError),queue.addEventListener("fileload",handleFileLoad),queue.loadManifest(n),filesToLoad=n.length}

function watchSound(e){
    "use strict";
    if("whereis"==e.slice(-7)){
        var a=getCharacter(selectedCharacterIndex);
                
        a.hasOwnProperty("happyPic")&&pulsate(a.happyPic,characterPulsateTime),a.hasOwnProperty("handPic")&&pulsate(a.handPic,characterPulsateTime)
    }
        
        if("whereblue"==e||"wherered"==e||"whereyellow"==e||"wheregreen"==e)null!=nextBall?pulsate(nextBall,ballPulsateTime):console.log("################################");else if("tada"==e)showStar();else if("gets"==e.slice(-5,-1)){var t=parseInt(e.slice(-1),10);showNumberId=setTimeout(showNumber,showNumberDelay,t)}}

function noGameRunning(){"use strict";return!menuBall.focus&&!menuCake.focus&&!menuClothes.focus}function handleComplete(){"use strict";filesToLoad>loadedFiles?progressBar.graphics.beginFill(progressBarErrorColor).drawRect(0,0,canvasWidth,progressBar.height):createjs.Tween.get(progressBar).to({alpha:0},progressBarFadeTime).call(function(){stage.removeChild(progressBar)}),addBoelToreSplash(),addHelp(),addTable(),addBall(),addClothes(),addBackButton(),addNumbers(),addStar(),addHelpBackground(),useRAF?createjs.Ticker.timingMode=createjs.Ticker.RAF:(createjs.Ticker.timingMode=createjs.Ticker.TIMEOUT,createjs.Ticker.framerate=fps),stage.update(),createjs.Ticker.addEventListener("tick",handleTick),debug&&(fpsLabel=new createjs.Text("-- fps","bold 24px Arial","#FFF"),fpsLabel.name="fps label",stage.addChild(fpsLabel),fpsLabel.x=10,fpsLabel.y=160)}function handleTick(e){"use strict";nowMillis=createjs.Ticker.getTime(!1),nowMillis-lastWakeTime>wakeInterval&&(update=!0,lastWakeTime=nowMillis),(update||debugAlwaysUpdate)&&(menuBall.focus&&checkBallOutsideAndBallBounce(),stage.update(e)),debug&&(fpsLabel.text=Math.round(createjs.Ticker.getMeasuredFPS())+" fps"),update=createjs.Tween.hasActiveTweens()}function handleBackButtonTouch(){"use strict";menuBall.focus?hideBallGame():menuCake.focus?hideCakeGame():menuClothes.focus&&restoreMenuClothes()}function changeBackground(e){"use strict";canvas.style.backgroundColor=e[0];var a=document.getElementById("canvasHolder");a.style.backgroundColor=e[1]}function createBackground(e,a){"use strict";var t=new createjs.Shape;return t.graphics.beginFill(e).drawRect(0,0,canvasWidth,canvasHeight),t.x=0,t.y=0,t.alpha=a,t}function handleHelpBackgroundTouch(e){"use strict";debug&&(console.log("background touch",e.stageX,e.stageY),helpBackground.touchX=e.stageX,helpBackground.touchY=e.stageY,stage.update()),hideHelp()}function printDebug(e){"use strict";debug&&(debugText.text+=e,debugText.text=debugText.text.substring(debugText.text.length-68,debugText.text.length))}function handleFileError(){"use strict"}function handleFileLoad(e){"use strict";printDebug(e.item.src+","),loadedFiles+=1;var a=loadedFiles/filesToLoad;updateProgressBar(a)}function updateProgressBar(e){"use strict";progressBar.scaleX=e,stage.update()}function addProgressBar(){"use strict";progressBar=new createjs.Shape,progressBar.graphics.beginFill(progressBarColor).drawRect(0,0,canvasWidth,progressBarHeight),progressBar.x=0,progressBar.y=0,progressBar.scaleX=.05,progressBar.height=progressBarHeight,progressBar.name="progress bar",stage.addChild(progressBar)}function addHelpBackground(){"use strict";helpBackground=createBackground("#FFFFFF",.5),helpBackground.addEventListener("mousedown",handleHelpBackgroundTouch)}function addHelp(){"use strict";menuHelp=new createjs.Bitmap(queue.getResult("menuHelp")),menuHelp.name="menu help",stage.addChild(menuHelp),menuHelp.x=menuHelpX,menuHelp.y=menuHelpY,menuHelp.alpha=1,menuHelp.addEventListener("mousedown",handleMenuHelpTouch),helpContainer=new createjs.Container,helpContainer.x=100,helpContainer.y=100,helpContainer.visible=!1,helpFrame=new createjs.Shape,helpFrame.graphics.beginFill("white").beginStroke("orange").setStrokeStyle(20,"round","round").drawRect(0,0,canvasWidth-200,canvasHeight-200),helpTextBox=new createjs.Text("","36px sans-serif","#000"),helpTextBox.lineHeight=42,helpTextBox.lineWidth=canvasWidth-400,helpTextBox.x=100,helpTextBox.y=100,helpContainer.addChild(helpFrame),helpContainer.addChild(helpTextBox),menuHelp.focus=!1}function addStar(){"use strict";star=new createjs.Bitmap(queue.getResult("star")),star.regX=star.image.width/2|0,star.regY=star.image.height/2|0,star.x=canvasWidth/2|0,star.y=canvasHeight/2|0,star.name="star",hideStar()}function addDebugText(){"use strict";debugText=new createjs.Text("","24px Courier","#000"),debugText.name="debug text",debugText.x=20,debugText.y=canvasHeight-30,debugText.text=debug?"Debug on":" ",stage.addChild(debugText)}function showSplashScreen(){"use strict";stage.addChildAt(boelToreSplash,0),stage.addChild(menuCake),stage.addChild(menuBall),stage.addChild(menuClothes);var e=1;createjs.Tween.get(menuCake).to({alpha:e},gameTransitionTime,createjs.Ease.linear),createjs.Tween.get(menuBall).to({alpha:e},gameTransitionTime,createjs.Ease.linear),createjs.Tween.get(menuClothes).to({alpha:e},gameTransitionTime,createjs.Ease.linear),createjs.Tween.get(backButton).to({alpha:1-e},gameTransitionTime,createjs.Ease.linear),createjs.Tween.get(boelToreSplash).to({alpha:e},gameTransitionTime/2,createjs.Ease.linear),changeBackground(splashScreenBackgroundColor),createjs.Tween.get(menuHelp).to({x:menuHelpX,y:menuHelpY},gameTransitionTime/2,createjs.Ease.linear)}function hideSplashScreen(){"use strict";var e=0;createjs.Tween.get(menuCake).to({alpha:e},gameTransitionTime,createjs.Ease.linear).call(function(){stage.removeChild(menuCake)}),createjs.Tween.get(menuBall).to({alpha:e},gameTransitionTime,createjs.Ease.linear).call(function(){stage.removeChild(menuBall)}),createjs.Tween.get(menuClothes).to({alpha:e},gameTransitionTime,createjs.Ease.linear).call(function(){stage.removeChild(menuClothes)}),createjs.Tween.get(backButton).to({alpha:1-e},gameTransitionTime,createjs.Ease.linear),createjs.Tween.get(boelToreSplash).to({alpha:e},gameTransitionTime/2,createjs.Ease.linear).call(function(){stage.removeChild(boelToreSplash)}),createjs.Tween.get(menuHelp).to({x:menuHelpRunningX,y:menuHelpRunningY},gameTransitionTime/2,createjs.Ease.linear)}function handleMenuHelpTouch(){"use strict";noGameRunning()?showHelp(generalHelpText,generalHelpSounds):menuCake.focus?showHelp(cakeHelpText,cakeHelpSounds):menuBall.focus?showHelp(ballHelpText,ballHelpSounds):menuClothes.focus&&showHelp(clothesHelpText,clothesHelpSounds)}function showHelp(e,a){"use strict";helpTextBox.text=e,helpContainer.visible=!0,stage.addChild(helpBackground),stage.addChild(helpContainer),stage.update(),extendAndPlayQueue(a)}function hideHelp(){"use strict";helpTextBox.text="",stage.removeChild(helpContainer),stage.removeChild(helpBackground),helpContainer.visible=!1,removeAllButFirstSound(),stage.update()}function isRunning(){"use strict";return createjs.Tween.hasActiveTweens()}function addBoelToreSplash(){"use strict";boelToreSplash=new createjs.Bitmap(queue.getResult("boelToreSplash")),boelToreSplash.name="Splash screen",stage.addChildAt(boelToreSplash,0)}function addBackButton(){"use strict";backButton=new createjs.Bitmap(queue.getResult("backButton")),stage.addChild(backButton),backButton.x=backButtonX,backButton.y=backButtonY,backButton.alpha=0,backButton.name="Back button",backButton.addEventListener("mousedown",handleBackButtonTouch)}function extendAndPlayQueue(e){"use strict";var a=soundQueue.length;soundQueue=soundQueue.concat(e),0==a&&playQueue()}function playQueue(){"use strict";console.log("playQueue: ",soundQueue);var e,a;soundQueue.length>0&&(e=soundQueue[0],watchSound(e),printDebug(e),a=createjs.Sound.play(e),"playFailed"!=a.playState?a.addEventListener("complete",handleNextSound):(console.log("play failed"),handleNextSound(null)))}function getPlayingSound(){"use strict";return soundQueue.length>0?soundQueue[0]:""}function playSingle(e){"use strict";var a;a=createjs.Sound.play(e)}function handleNextSound(){"use strict";soundQueue.splice(0,1),playQueue()}function removeNextSound(){"use strict";soundQueue.splice(1,1)}function removeAllButFirstSound(){"use strict";soundQueue=soundQueue.splice(0,1)}function showStar(){"use strict";stage.addChild(star),createjs.Tween.get(star).to({alpha:.7,scaleX:2.3,scaleY:2.3},2e3,createjs.Ease.getElasticOut(1,.3)).wait(1e3).to({alpha:0},1e3).to({scaleX:.1,scaleY:.1},10)}function hideStar(){"use strict";createjs.Tween.removeTweens(star),star.alpha=0,star.scaleX=.1,star.scaleY=.1,stage.removeChild(star)}function randomFutureMillis(e,a){"use strict";var t=e+Math.random()*(a-e);return 1e3*t}function pulsate(e,a){"use strict";var t=Math.floor(a/500+.5),s=Math.floor(a/2/t);pulsateOne(e,s,t)}function pulsateOne(e,a,t){"use strict";1>=t?createjs.Tween.get(e).to({scaleX:1.1,scaleY:1.1},a,createjs.Ease.sineInOut).to({scaleX:1,scaleY:1},a,createjs.Ease.sineInOut):createjs.Tween.get(e).to({scaleX:1.1,scaleY:1.1},a,createjs.Ease.sineInOut).to({scaleX:1,scaleY:1},a,createjs.Ease.sineInOut).call(function(){pulsateOne(e,a,t-1)})}function log(e){"use strict";console.log(e),console.log("active tweens: "+createjs.Tween.hasActiveTweens())}function checkCharacter(){"use strict";if(console.log("checking character"),soundQueue.length>0||helpContainer.visible)console.log("not ready to check character"),randomCheckId=setTimeout(checkCharacter,2e3);else{var e=selectNextCharacter();e&&(clearTimeout(randomCheckId),nextRandomCheck=-1)}}function selectNextCharacter(){"use strict";function e(e,t){e.moved||a.push(t)}console.log("selecting next charavter");var a=[],t=!1;if(-1==selectedCharacterIndex&&(allPieces.forEach(e),a.length>0)){var s=Math.floor(Math.random()*a.length);selectedCharacterIndex=a[s],selectedName=getCharacterNameSound(selectedCharacterIndex),extendAndPlayQueue([selectedName+"wouldlike",selectedName+"whereis",selectedName+"tap"]),t=!0}return t}function smashNextPiece(){"use strict";function e(e,t){e.moved&&!e.smashed&&a.push(t)}console.log("trying to smash next piece");var a=[];if(isRunning()||helpContainer.visible)console.log("not ready to smash yet"),clearTimeout(nextSmashId),nextSmashId=setTimeout(smashNextPiece,2e3);else if(allPieces.forEach(e),a.length>0){var t=Math.floor(Math.random()*a.length),s=a[t];bounceToTable(s),nextSmash=randomFutureMillis(minSecNextSmash,maxSecNextSmash),clearTimeout(nextSmashId),nextSmashId=setTimeout(smashNextPiece,nextSmash)}}function handleCharacterTouch(e){"use strict";var a=e.target.character;a.hasCake===!1&&moveCakePiece(a)}function handleMenuCakeTouch(){"use strict";noGameRunning()&&(menuCake.focus=!0,extendAndPlayQueue(["silence1000"]),hideSplashScreen(),showCakeGame(),startCakeGame())}function showCakeGame(){"use strict";changeBackground(tableBackgroundColor),showTable()}function showTable(){"use strict";table.removeAllChildren(),table.addChild(tableMom.happyPic,tableGrandDad.happyPic,tableBoel.happyPic,tableDad.happyPic,tableTore.happyPic,tableTable,tableDog.happyPic,tableMom.handPic,tableGrandDad.handPic,tableBoel.handPic,tableDad.handPic,tableTore.handPic,cakeContainer);var e,a;for(a=0;a<allPieces.length;a+=1)e=allPieces[a],e.smashed=!1,e.moved=!1;var t;for(a=0;numberOfCakePieces+1>a;a+=1)t=allCakes[a],t.alpha=1;piecesLeft=numberOfCakePieces,cakeContainer.removeAllChildren(),cakeContainer.addChild(allCakes[piecesLeft]);var s;for(a=0;a<allCharacters.length;a+=1)s=allCharacters[a],restoreCharacter(s);restoreCakeBall(),stage.addChild(table),createjs.Tween.get(table).to({alpha:1},gameTransitionTime,createjs.Ease.linear)}function startCakeGame(){"use strict";nextRandomCheck=randomFutureMillis(minSecSelectFirstName,maxSecSelectFirstName),randomCheckId=setTimeout(checkCharacter,nextRandomCheck)}function hideCakeGame(){"use strict";menuCake.focus=!1,createjs.Tween.removeAllTweens(),soundQueue=[],clearTimeout(nextSmashId),clearTimeout(randomCheckId),clearTimeout(showNumberId),clearTimeout(tadaId),nextRandomCheck=-1,selectedCharacterIndex=-1,selectedName="",hideAllNumbers(),hideStar(),showSplashScreen(),createjs.Tween.get(table).to({alpha:0},gameTransitionTime,createjs.Ease.linear).call(function(){stage.removeChild(table)})}function addNumbers(){"use strict";var e,a;for(e=0;numberOfCakePieces>=e;e+=1)a=new createjs.Bitmap(queue.getResult(e+"")),a.x=numberX,a.y=numberY,a.regX=a.image.width/2|0,a.regY=a.image.height/2|0,a.alpha=0,a.name=e+"",numbers.push(a),numberBackground=new createjs.Shape,numberBackground.graphics.beginFill("white").drawEllipse(canvasWidth/2,canvasHeight/2,numberBackgroundWidth,numberBackgroundHeight),numberBackground.regX=numberBackgroundWidth/2,numberBackground.regY=numberBackgroundHeight/2,numberBackground.alpha=.6,numberBackground.name="Number background"}function addTable(){"use strict";table=new createjs.Container,addCake(numberOfCakePieces),addCakeBall(),table.name="Table container",tableDog=new Character(181,605,0,417,535,"tableDog",!0,!1,0,0,"Dog"),tableTore=new Character(719,490,1,594,475,"tableTore",!0,!0,0,163,"Tore"),tableDad=new Character(658,266,2,587,319,"tableDad",!0,!0,2,295,"Dad"),tableGrandDad=new Character(411,175,3,527,265,"tableGrandDad",!0,!0,0,254,"Granddad"),tableMom=new Character(249,285,4,324,332,"tableMom",!0,!0,81,202,"Mum"),tableBoel=new Character(191,417,5,310,444,"tableBoel",!0,!0,107,121,"Boel"),allCharacters=[tableDog,tableTore,tableDad,tableGrandDad,tableMom,tableBoel],tableTable=new createjs.Bitmap(queue.getResult("tableTable")),tableTable.x=139,tableTable.y=267,tableTable.name="Table",table.x=tableX,table.y=tableY,table.alpha=0,table.addEventListener("mousedown",handleTableTouch)}function handleTableTouch(e){"use strict";e.stageX,e.stageY}function addCharacterEventListener(e){"use strict";e.hasOwnProperty("happyPic")&&e.happyPic.addEventListener("mousedown",handleCharacterTouch),e.hasOwnProperty("sadPic")&&e.sadPic.addEventListener("mousedown",handleCharacterTouch),e.hasOwnProperty("handPic")&&e.handPic.addEventListener("mousedown",handleCharacterTouch)}function restoreCharacter(e){"use strict";e.mood="happy",e.hasCake=!1}function makeCharacterSad(e){"use strict";e.hasOwnProperty("sadPic")&&"happy"==e.mood&&(table.addChildAt(e.sadPic,table.getChildIndex(e.happyPic)),table.removeChild(e.happyPic)),e.mood="sad"}function addCake(e){"use strict";menuCake=new createjs.Bitmap(queue.getResult("menuCake")),stage.addChild(menuCake),menuCake.x=menuCakeX,menuCake.y=menuCakeY,menuCake.name="menu cake",menuCake.alpha=1,menuCake.focus=!1,menuCake.addEventListener("mousedown",handleMenuCakeTouch);var a=[{x:30,y:-6},{x:21,y:-26},{x:-23,y:-25},{x:-29,y:0},{x:-17,y:14},{x:27,y:14},{x:0,y:0}];cakeContainer=new createjs.Container,allCakes=[];var t,s;for(t=0;e+1>t;t+=1)s=new createjs.Bitmap(queue.getResult("cake"+t)),s.regX=s.image.width/2|0,s.regY=s.image.height/2|0,s.missingPieceX=a[t].x,s.missingPieceY=a[t].y,s.name="cake with "+t+" pieces",allCakes.push(s);cakeContainer.x=450,cakeContainer.y=380,cakeContainer.name="cake",allPieces=[],allSmashedPieces=[];var r,l;for(t=1;e+1>t;t+=1)r=new createjs.Bitmap(queue.getResult("piece"+t)),l=new createjs.Bitmap(queue.getResult("smashedPiece"+t)),r.regX=r.image.width/2|0,r.regY=r.image.height/2|0,r.x=0,r.y=0,r.alpha=0,r.moved=!1,r.smashed=!1,r.name="piece "+t,l.regX=l.image.width/2|0,l.regY=l.image.height/2|0,l.name="smashed piece "+t,allPieces.push(r),allSmashedPieces.push(l)}function addCakeBall(){"use strict";cakeBall=new createjs.Bitmap(queue.getResult("cakeBall")),cakeBall.regX=cakeBall.image.width/2|0,cakeBall.regY=cakeBall.image.height/2|0,cakeBall.name="cake ball",restoreCakeBall()}function moveCakePiece(e){"use strict";var a=e.pieceNumber,t=e.pieceX,s=e.pieceY,r=getPlayingSound(),l=allPieces[a],n=getCharacterNameSound(a),i=getCharacterNameSound(selectedCharacterIndex),o=selectedCharacterIndex==a;if(menuCake.focus&&(""==r||o&&"but"==r.slice(-3)||o&&"wouldlike"==r.slice(-9)||o&&"whereis"==r.slice(-7)||o&&"tap"==r.slice(-3))){"but"==r.slice(-3)?(removeNextSound(),removeNextSound()):"wouldlike"==r.slice(-9)?(removeNextSound(),removeNextSound()):"whereis"==r.slice(-7)&&removeNextSound();var c=allCakes[piecesLeft];piecesLeft-=1;var d=allCakes[piecesLeft];cakeContainer.addChildAt(d,cakeContainer.getChildIndex(c)),l.x=d.missingPieceX+cakeContainer.x,l.y=d.missingPieceY+cakeContainer.y,table.addChild(l),createjs.Tween.get(c).to({alpha:0},400,createjs.Ease.linear).call(function(){cakeContainer.removeChild(c)}),createjs.Tween.get(l).to({alpha:1},200,createjs.Ease.linear).wait(10).to({x:t,y:s},700,createjs.Ease.linear),l.moved=!0,e.hasCake=!0,nextSmash=randomFutureMillis(minSecNextSmash,maxSecNextSmash),clearTimeout(nextSmashId),nextSmashId=setTimeout(smashNextPiece,nextSmash);var u=numberOfCakePieces-piecesLeft;o?(extendAndPlayQueue(["yes"]),extendAndPlayQueue([n+"gets"+u]),selectedCharacterIndex=-1,nextRandomCheck=randomFutureMillis(minSecSelectName,maxSecSelectName),clearTimeout(randomCheckId),randomCheckId=setTimeout(checkCharacter,nextRandomCheck)):-1==selectedCharacterIndex?(extendAndPlayQueue([n+"gets"+u]),selectedCharacterIndex=-1,nextRandomCheck=randomFutureMillis(minSecSelectName,maxSecSelectName),clearTimeout(randomCheckId),randomCheckId=setTimeout(checkCharacter,nextRandomCheck)):extendAndPlayQueue([n+"gets"+u,"silence300",i+"but",selectedName+"whereis",selectedName+"tap"]),0==piecesLeft&&extendAndPlayQueue(["tada"])}}function bounceToTable(e){"use strict";var a=Math.floor(1e3*cakeBounceTime/4),t=cakeBall.x,s=cakeBall.y,r=allPieces[e].x,l=allPieces[e].y,n=t+3.9*(r-t);pieceNumberToSmash=e,table.addChild(cakeBall),createjs.Tween.get(cakeBall).to({x:n,rotation:360*cakeBallNoOfTurns},3.9*a,createjs.Ease.linear),createjs.Tween.get(cakeBall).to({y:l},a,createjs.Ease.getPowIn(2)).call(smashPiece).to({y:s},a,createjs.Ease.getPowOut(2)).to({y:l},a,createjs.Ease.getPowIn(2)).to({y:s},a,createjs.Ease.getPowOut(2)).call(restoreCakeBall)}function restoreCakeBall(){"use strict";table.removeChild(cakeBall),cakeBall.x>canvasWidth+100-tableX?(cakeBall.x=canvasWidth+100-tableX,cakeBall.y=100-tableY):cakeBall.x<-100-tableX?(cakeBall.x=-100-tableX,cakeBall.y=100-tableY):(cakeBall.x=canvasWidth+100-tableX,cakeBall.y=100-tableY),cakeBall.rotation=0}function smashPiece(){"use strict";var e=allPieces[pieceNumberToSmash];playSingle("cakebounce");var a=getCharacter(pieceNumberToSmash);makeCharacterSad(a),e.smashed=!0;var t=allSmashedPieces[pieceNumberToSmash];t.x=e.x,t.y=e.y,table.removeChild(e),table.addChildAt(t,table.getChildIndex(cakeBall))}function getCharacterNameSound(e){"use strict";var a=getCharacter(e);return a.hasOwnProperty("name")?a.name.toLowerCase():""}function getCharacter(e){"use strict";return e>-1?allCharacters[e]:{}}function Character(e,a,t,s,r,l,n,i,o,c,d){"use strict";this.pieceNumber=t,this.pieceDeltaX=s,this.pieceDeltaY=r,this.pieceX=s,this.pieceY=r,this.happyPic=new createjs.Bitmap(queue.getResult(l)),this.happyPic.character=this,this.happyPic.regX=this.happyPic.image.width/2|0,this.happyPic.regY=this.happyPic.image.height/2|0,this.happyPic.x=e,this.happyPic.y=a,this.happyPic.name=d+" happy",n&&(this.sadPic=new createjs.Bitmap(queue.getResult(l+"Sad")),this.sadPic.character=this,this.sadPic.regX=this.happyPic.regX,this.sadPic.regY=this.happyPic.regY,this.sadPic.x=this.happyPic.x,this.sadPic.y=this.happyPic.y,this.sadPic.name=d+" sad"),i&&(this.handPic=new createjs.Bitmap(queue.getResult(l+"Hand")),this.handPic.character=this,this.handPic.regX=this.happyPic.regX-o,this.handPic.regY=this.happyPic.regY-c,this.handPic.x=this.happyPic.x,this.handPic.y=this.happyPic.y,this.handPic.name=d+" hand"),this.name=d,restoreCharacter(this),addCharacterEventListener(this)}function hideAllNumbers(){"use strict";var e;for(e=0;e<numbers.length;e+=1)numbers[e].alpha=0,stage.removeChild(numbers[e]);stage.removeChild(numberBackground)}function showNumber(e){"use strict";var a=numbers[e];e>1&&(numbers[e-1].alpha=0,stage.removeChild(numbers[e-1])),a.x=canvasWidth/2,a.y=canvasHeight/2,a.scaleX=3,a.scaleY=3,stage.addChild(numberBackground),stage.addChild(a),createjs.Tween.get(a).to({alpha:1},numberAppearTime,createjs.Ease.linear).wait(numberWaitTime).call(function(){stage.removeChild(numberBackground)}).to({x:numberX,y:numberY,scaleX:1,scaleY:1},numberMoveTime,createjs.Ease.linear)}function handleNextBall(){"use strict";isRunning()||helpContainer.visible?(console.log("not ready for next ball yet"),nextBallId=setTimeout(handleNextBall,2e3)):menuBall.focus&&(nextBall=findRandomBall(),extendAndPlayQueue("where"+nextBall.color),nextBallTime=-1)}function checkBallOutsideAndBallBounce(){"use strict";if(ballTween.hasOwnProperty("target")){var e=ballTween.target,a=e.x-e.radius<canvasWidth&&e.y-e.radius<canvasHeight&&e.x+e.radius>0&&e.y+e.radius>0;if(a||(e.inside=!1,e.alpha=0,ballTween.setPaused(!0),e.last&&(extendAndPlayQueue("tada"),startBallGame(timeToNewBallGame))),detectBallCollision(e,0)&&e.obstacleBall!=e.lastObstacleBall){isRunning(ballTween)&&ballTween.setPaused(!0);var t=Math.atan2(e.y-e.obstacleBall.y,e.x-e.obstacleBall.x);e.bounceAngle=2*t-Math.PI-e.startAngle;var s=minBounceDistance*Math.cos(e.bounceAngle),r=minBounceDistance*Math.sin(e.bounceAngle),l=e.x+s,n=e.y+r;ballTween=makeBallTween(e,l,n,ballBounceSpeed)}}}function makeBallTween(e,a,t,s){"use strict";var r=Math.sqrt((a-e.x)*(a-e.x)+(t-e.y)*(t-e.y)),l=Math.floor(r/s);e.startAngle=Math.atan2(t-e.y,a-e.x);var n=randomDirection()*Math.floor(360*r/600);return createjs.Tween.get(e).to({x:a,y:t,rotation:e.rotation+n},l,createjs.Ease.linear)}function randomDirection(){"use strict";return Math.random()<.5?-1:1}function randomSpeedAndDirection(){"use strict";return 2*Math.random()-1}function handleMenuBallTouch(){"use strict";noGameRunning()&&(menuBall.focus=!0,extendAndPlayQueue(["silence1000"]),hideSplashScreen(),showBallGame(),startBallGame(0))}function showBallGame(){"use strict";changeBackground(ballBackgroundColor),showBalls()}function startBallGame(e){"use strict";hideStar(),nextBallTime=e+randomFutureMillis(minSecNextBall,maxSecNextBall),nextBallId=setTimeout(handleNextBall,nextBallTime),nextBall=null,allBalls.forEach(setRandomPosition);var a;for(a=0;a<allBalls.length;a+=1)allBalls[a].scaleX=.1,allBalls[a].scaleY=.1,createjs.Tween.get(allBalls[a]).wait(e).to({scaleX:1,scaleY:1,alpha:1,rotation:allBalls[a].rotation+randomSpeedAndDirection()*startBallGameNoOfTurns*360},startBallGameRotationTime,createjs.Ease.linear)}function hideBallGame(){"use strict";menuBall.focus=!1,nextBallTime=-1,clearTimeout(nextBallId);var e;for(e=0;e<allBalls.length;e+=1)createjs.Tween.removeTweens(allBalls[e]);hideBalls(),hideStar(),showSplashScreen()}function addBall(){"use strict";menuBall=new createjs.Bitmap(queue.getResult("menuBall")),stage.addChild(menuBall),menuBall.x=menuBallX,menuBall.y=menuBallY,menuBall.name="menu ball",menuBall.alpha=1,menuBall.focus=!1,menuBall.addEventListener("mousedown",handleMenuBallTouch),blueBall=new Ball("blueBall","Blå boll","blue"),redBall=new Ball("redBall","Röd boll","red"),yellowBall=new Ball("yellowBall","Gul boll","yellow"),greenBall=new Ball("greenBall","Grön boll","green"),allBalls=[blueBall,redBall,yellowBall,greenBall]}function showBalls(){"use strict";var e;for(e=0;e<allBalls.length;e+=1)stage.addChild(allBalls[e])}function hideBalls(){"use strict";var e;for(e=0;e<allBalls.length;e+=1)stage.removeChild(allBalls[e])}function setRandomPosition(e){"use strict";for(var a=!1,t=ballMinDistance/2;!a;)e.x=Math.floor(Math.random()*(canvasWidth-2*ballMinBorderDistance)+ballMinBorderDistance),e.y=Math.floor(Math.random()*(canvasHeight-2*ballMinBorderDistance)+ballMinBorderDistance),a=!detectBallCollision(e,t);e.rotation=Math.floor(360*Math.random()),e.inside=!0,e.last=!1,delete e.obstacleBall,delete e.lastObstacleBall}function collides(e,a,t){"use strict";var s=e.x-a.x,r=e.y-a.y,l=s*s+r*r,n=e.radius+a.radius+t,i=n*n;return i>l}function findRandomBall(e){"use strict";var a,t=[];for(a=0;a<allBalls.length;a+=1)allBalls[a]!=e&&allBalls[a].inside&&t.push(allBalls[a]);var s=Math.floor(Math.random()*t.length);return t.length>0?t[s]:null}function detectBallCollision(e,a){"use strict";var t,s=!1,r={};for(t=0;t<allBalls.length&&!s;t+=1)allBalls[t]!=e&&allBalls[t].inside&&(r=allBalls[t],s=collides(e,r,a),s&&(e.hasOwnProperty("obstacleBall")&&(e.lastObstacleBall=e.obstacleBall),e.obstacleBall=r));
return s}function handlePlayBallTouch(e){"use strict";var a=e.target;if(""==getPlayingSound())if(a==nextBall){extendAndPlayQueue("yes"+a.color);var t=findRandomBall(a);if(null!==t){var s=t.x+.35*t.image.width*randomDirection(),r=t.y+.35*t.image.width*randomDirection();ballTween=makeBallTween(a,s,r,ballBounceSpeed),nextBall=null,nextBallTime=randomFutureMillis(minSecNextBall,maxSecNextBall),nextBallId=setTimeout(handleNextBall,nextBallTime)}else{var l=2*Math.random()*Math.PI,n=minBounceDistance*Math.cos(l),i=minBounceDistance*Math.sin(l);a.last=!0,ballTween=makeBallTween(a,n,i,ballBounceSpeed)}}else if(null!==nextBall){var o=a.rotation;createjs.Tween.get(a).to({rotation:o+360*wrongBallNumberOfTurns},wrongBallTurnTime,createjs.Ease.sineInOut),extendAndPlayQueue(["thatwas"+a.color,"where"+nextBall.color])}}function Ball(e,a,t){"use strict";createjs.Bitmap.call(this,queue.getResult(e)),this.regX=this.image.width/2|0,this.regY=this.image.height/2|0,this.name=a,this.color=t,this.addEventListener("mousedown",handlePlayBallTouch),this.alpha=0,this.radius=this.regX,this.last=!1}function Clothes(e,a,t,s,r,l,n,i,o){"use strict";this.linePic=new createjs.Bitmap(queue.getResult(e)),this.linePic.clothes=this,this.wearPic=new createjs.Bitmap(queue.getResult(a)),this.wearPic.clothes=this,this.linePic.alpha=1,this.wearPic.alpha=0,this.linePic.startX=this.linePic.x=r,this.linePic.startY=this.linePic.y=l,this.linePic.regX=this.linePic.image.width/2|0,this.linePic.regY=this.linePic.image.height/2|0,this.linePic.startRotation=this.linePic.rotation=s,this.linePic.tweening=!1,this.linePic.wearX=n,this.linePic.wearY=i,this.linePic.kind="linePic",this.wearPic.regX=this.wearPic.image.width/2|0,this.wearPic.regY=this.wearPic.image.height/2|0,this.wearPic.startRotation=this.wearPic.rotation=s,this.extraArea=new createjs.Shape,this.extraArea.graphics.beginFill(clothesBackgroundColor[0]).drawCircle(0,0,50,50),this.extraArea.x=r,this.extraArea.y=l,this.extraArea.clothes=this,this.extraArea.startX=r,this.extraArea.startY=l,this.extraArea.kind="extraArea",this.onBody=!1,o&&(this.extraArea.addEventListener("mousedown",handlePrePressmoveMousedown),this.extraArea.addEventListener("pressmove",handlePressmove),this.extraArea.addEventListener("pressup",handlePostPressmovePressup),this.linePic.addEventListener("mousedown",handlePrePressmoveMousedown),this.linePic.addEventListener("pressmove",handlePressmove),this.linePic.addEventListener("pressup",handlePostPressmovePressup))}function addClothes(){"use strict";menuClothes=new createjs.Bitmap(queue.getResult("menuClothes")),stage.addChild(menuClothes),menuClothes.x=menuClothesX,menuClothes.y=menuClothesY,menuClothes.name="menu clothes",menuClothes.alpha=1,menuClothes.focus=!1,menuClothes.addEventListener("mousedown",handleMenuClothesTouch),clothesGameContainer=new createjs.Container,clothesGameContainer.x=clothesGameContainerX,clothesGameContainer.y=clothesGameContainerY,clothesGameContainer.alpha=0,clothesGameContainer.drawingEnabled=!1,tore=new createjs.Bitmap(queue.getResult("tore")),tore.sad=new createjs.Bitmap(queue.getResult("toreSad")),tore.startX=tore.x=toreX,tore.startY=tore.y=toreY,tore.regX=tore.image.width/2|0,tore.regY=tore.image.height/2|0,tore.sad.x=tore.x-42,tore.sad.y=tore.y-156,tore.sad.alpha=0,tore.rotation=0,tore.dressed=!1,sockRight=new Clothes("sockRightLine","sockRightWear","sockRight",sockRightStartRotation,sockRightX,sockRightY,sockRightWearX,sockRightWearY,!0),sockLeft=new Clothes("sockLeftLine","sockLeftWear","sockLeft",sockLeftStartRotation,sockLeftX,sockLeftY,sockLeftWearX,sockLeftWearY,!0),trousers=new Clothes("trousersLine","trousersWear","trousers",trousersStartRotation,trousersX,trousersY,trousersWearX,trousersWearY,!0),shirt=new Clothes("shirtLine","shirtWear","shirt",shirtStartRotation,shirtX,shirtY,shirtWearX,shirtWearY,!0),clothesGameContainer.clean=!0,line=new createjs.Bitmap(queue.getResult("line")),line.x=lineX,line.y=lineY,paintDetect.push(tore),paintDetect.push(shirt.wearPic),paintDetect.push(sockLeft.wearPic),paintDetect.push(sockRight.wearPic),paintDetect.push(trousers.wearPic),clothesGameContainer.addChild(sockRight.extraArea),clothesGameContainer.addChild(sockLeft.extraArea),clothesGameContainer.addChild(tore),clothesGameContainer.addChild(tore.sad),clothesGameContainer.addChild(sockRight.wearPic),clothesGameContainer.addChild(sockLeft.wearPic),clothesGameContainer.addChild(trousers.wearPic),clothesGameContainer.addChild(shirt.wearPic),clothesGameContainer.addChild(sockRight.linePic),clothesGameContainer.addChild(sockLeft.linePic),clothesGameContainer.addChild(trousers.linePic),clothesGameContainer.addChild(shirt.linePic),clothesGameContainer.addChild(line),clothesGameContainer.name="clothes game container",stage.addChild(clothesGameContainer)}function handleMenuClothesTouch(){"use strict";noGameRunning()&&(menuClothes.focus=!0,extendAndPlayQueue(["silence1000"]),hideSplashScreen(),showClothesGame(),startClothesGame(0))}function startClothesGame(){"use strict";line.alpha=1,tore.alpha=1,tore.dressed=!1,createjs.Tween.get(clothesGameContainer).to({alpha:1},gameTransitionTime,createjs.Ease.linear)}function restorePieceOfClothes(e){"use strict";log("restorePieceOfClothes()"),createjs.Tween.removeTweens(e.linePic),createjs.Tween.removeTweens(e.wearPic),e.linePic.rotation=e.linePic.startRotation,e.wearPic.rotation=e.wearPic.startRotation,e.linePic.alpha=1,e.wearPic.alpha=0,e.linePic.x=e.linePic.startX,e.linePic.y=e.linePic.startY,e.extraArea.x=e.extraArea.startX,e.extraArea.y=e.extraArea.startY,e.extraArea.alpha=1,e.onBody=!1}function restoreMenuClothes(){"use strict";menuClothes.focus=!1,log("restoreMenuClothes()"),restorePieceOfClothes(shirt),restorePieceOfClothes(trousers),restorePieceOfClothes(sockLeft),restorePieceOfClothes(sockRight),clothesGameContainer.drawingEnabled&&disableDrawing(),menuClothes.focus=!1,hideClothes(),hideStar(),showSplashScreen()}function hideClothes(){"use strict";log("hideClothes()"),createjs.Tween.get(clothesGameContainer).to({alpha:0},gameTransitionTime,createjs.Ease.linear)}function showClothesGame(){"use strict";changeBackground(clothesBackgroundColor)}function handlePrePressmoveMousedown(e){"use strict";var a,t;"linePic"==e.target.kind?(a=e.target,t=a.clothes.extraArea):"extraArea"==e.target.kind&&(t=e.target,a=t.clothes.linePic),a.tweening||(a.mousedownOffset={x:e.stageX-a.x,y:e.stageY-a.y})}function handlePressmove(e){"use strict";var a,t;"linePic"==e.target.kind?(a=e.target,t=a.clothes.extraArea):"extraArea"==e.target.kind&&(t=e.target,a=t.clothes.linePic),a.tweening||(a.x=e.stageX-a.mousedownOffset.x,a.y=e.stageY-a.mousedownOffset.y,t.x=a.x,t.y=a.y,a.x>tore.x+a.wearX-hitDistance&&a.x<tore.x+a.wearX+hitDistance&&a.y>tore.y+a.wearY-hitDistance&&a.y<tore.y+a.wearY+hitDistance&&!a.clothes.onBody&&(a.clothes.onBody=!0,a.clothes.wearPic.x=a.x,a.clothes.wearPic.y=a.y,t.alpha=0,createjs.Tween.get(a).to({x:tore.x+a.wearX,y:tore.y+a.wearY,rotation:0,alpha:0},clothesTweenTime,createjs.Ease.linear),createjs.Tween.get(a.clothes.wearPic).to({x:tore.x+a.wearX,y:tore.y+a.wearY,rotation:0,alpha:1},clothesTweenTime,createjs.Ease.linear).wait(500).call(checkIfAllClothesOn)),update=!0)}function checkIfAllClothesOn(){"use strict";shirt.onBody&&trousers.onBody&&sockLeft.onBody&&sockRight.onBody&&!tore.dressed&&(tore.dressed=!0,extendAndPlayQueue("tada"),createjs.Tween.get(line).to({alpha:0},500,createjs.Ease.linear).wait(3800).call(enableDrawing))}function handlePostPressmovePressup(e){"use strict";var a,t;if("linePic"==e.target.kind?(a=e.target,t=a.clothes.extraArea):"extraArea"==e.target.kind&&(t=e.target,a=t.clothes.linePic),!a.tweening&&!a.clothes.onBody){a.tweening=!0;var s=Math.sqrt((a.x-a.startX)*(a.x-a.startX)+(a.y-a.startY)*(a.y-a.startY)),r=s/returnSpeed;createjs.Tween.get(a).to({x:a.startX,y:a.startY},r,createjs.Ease.sineInOut).call(function(){a.tweening=!1}),createjs.Tween.get(t).to({x:t.startX,y:t.startY},r,createjs.Ease.sineInOut)}}function enableDrawing(){"use strict";if(helpContainer.visible)setTimeout(enableDrawing,2e3);else if(menuClothes.focus){clothesGameContainer.drawingEnabled=!0,menuHelp.alpha=0,stage.update(),stage.autoClear=!1,crayonColors=["red","yellow","green","#FFAABB","blue","orange","brown","purple"],crayonColorIndex=0,crayonColor=crayonColors[crayonColorIndex];var e;for(e=0;e<crayonColors.length;e+=1)crayons[e]=makeCrayon(crayonColors[e],"black",3),crayonsOverlay[e]=makeCrayon("lightblue","lightblue",4),crayons[e].index=e,crayonsOverlay[e].index=e,stage.addChild(crayonsOverlay[e]),stage.addChild(crayons[e]),crayons[e].addEventListener("mousedown",handleCrayonMouseDown),crayonsOverlay[e].addEventListener("mousedown",handleCrayonMouseDown);drawCrayons(crayonColorIndex),drawingCanvas=new createjs.Shape,drawingCanvas.name="drawing canvas",stage.addEventListener("stagemousedown",handleStrokeMouseDown),stage.addChild(drawingCanvas),stage.update()}}function disableDrawing(){"use strict";clothesGameContainer.drawingEnabled=!1,menuHelp.alpha=1,tore.sad.alpha=0,clothesGameContainer.clean=!0,line.alpha=1,stage.autoClear=!0,removeCrayons(),stage.removeChild(drawingCanvas),stage.removeEventListener("stagemousedown",handleStrokeMouseDown),stage.removeEventListener("stagemouseup",handleStrokeMouseUp),stage.removeEventListener("stagemousemove",handleStrokeMouseMove)}function removeCrayons(){"use strict";var e;for(e=0;e<crayonColors.length;e+=1)stage.removeChild(crayonsOverlay[e]),stage.removeChild(crayons[e])}function makeCrayon(e,a,t){"use strict";var s=new createjs.Shape;return s.name=e+" crayon",s.graphics.beginFill(e).beginStroke(a).setStrokeStyle(t,"round","round").moveTo(40,0).lineTo(200,0).lineTo(200,40).lineTo(40,40).lineTo(36,35).lineTo(2,23).lineTo(2,17).lineTo(36,5).lineTo(40,0).beginFill(a).drawRect(60,2,20,36).beginStroke(e).setStrokeStyle(7,"round","round").moveTo(70,2).curveTo(65,10,70,20).curveTo(75,30,70,38).beginStroke(a).setStrokeStyle(t-1,"round","round").moveTo(60,0).lineTo(80,0).moveTo(60,40).lineTo(80,40),s}function handleClothesPaint(){"use strict";clothesGameContainer.clean&&(clothesGameContainer.clean=!1,tore.sad.alpha=1,stage.update(),clothesGameContainer.alpha=0)}function drawCrayons(e){"use strict";var a,t=50,s=crayons.length,r=canvasHeight-(s+1)*t,l=100;for(a=0;s>a;a+=1)crayonsOverlay[a].y=r+a*t,crayonsOverlay[a].x=canvasWidth-l-2,crayons[a].y=r+a*t,crayons[a].x=a==e?canvasWidth-l:canvasWidth-l/2}function handleCrayonMouseDown(e){"use strict";crayonColorIndex=e.target.index,crayonColor=crayonColors[crayonColorIndex],drawCrayons(crayonColorIndex),stage.update()}function handleStrokeMouseDown(e){"use strict";var a=e.stageX,t=e.stageY;console.log("vvvvv handleStrokeMouseDown",0|a,0|t),detectPaint(a,t),stroke=10,oldPt=new createjs.Point(a,t),oldMidPt=new createjs.Point(a,t),drawingCanvas.graphics.clear().beginFill(crayonColor).drawCircle(oldPt.x,oldPt.y,stroke/2,stroke/2),stage.update(),stage.addEventListener("stagemousemove",handleStrokeMouseMove),stage.addEventListener("stagemouseup",handleStrokeMouseUp)}function handleStrokeMouseMove(e){"use strict";var a=e.stageX,t=e.stageY;console.log("<< >> handleStrokeMouseMove",0|a,0|t),detectPaint(a,t);var s=new createjs.Point(oldPt.x+a>>1,oldPt.y+t>>1);drawingCanvas.graphics.clear().setStrokeStyle(stroke,"round","round").beginStroke(crayonColor).moveTo(s.x,s.y).curveTo(oldPt.x,oldPt.y,oldMidPt.x,oldMidPt.y),oldPt.x=a,oldPt.y=t,oldMidPt.x=s.x,oldMidPt.y=s.y,stage.update()}function handleStrokeMouseUp(e){"use strict";var a=e.stageX,t=e.stageY;console.log("^^^^^ handleStrokeMouseUp  ",0|a,0|t),drawingCanvas.graphics.clear().setStrokeStyle(stroke,"round","round").beginStroke(crayonColor).moveTo(oldMidPt.x,oldMidPt.y).lineTo(a,t),stage.update(),stage.removeEventListener("stagemousemove",handleStrokeMouseMove),stage.removeEventListener("stagemouseup",handleStrokeMouseUp)}function detectPaint(e,a){"use strict";var t,s,r=!1;for(s=0;s<paintDetect.length&&!r;s+=1)t=paintDetect[s].globalToLocal(e,a),paintDetect[s].hitTest(t.x,t.y)&&(r=!0,handleClothesPaint())}var debug=!1,debugAlwaysUpdate=!1,fpsLabel,debugbutton1,canvasWidth=1024,canvasHeight=768;Ball.prototype=Object.create(createjs.Bitmap.prototype);var splashScreenBackgroundColor=["#86DBD5","#B5E7EF"],ballBackgroundColor=["#FFFF00","#F8FF88"],tableBackgroundColor=["#FF95CB","#FFC7E5"],clothesBackgroundColor=["#93D4F2","#BFEAF8"],wakeInterval=2e4,returnSpeed=.5,timeToNewBallGame=5e3,ballBounceSpeed=.4,minSecSelectFirstName=1.5,maxSecSelectFirstName=2,minSecSelectName=6,maxSecSelectName=8,minSecNextBall=3,maxSecNextBall=3.2,showNumberDelay=2e3,tadaDelay=6e3,progressBarHeight=20,progressBarColor="#060",progressBarErrorColor="#C00",progressBarFadeTime=400,useRAF=!0,fps=30,cakeBounceTime=6,minSecNextSmash=18,maxSecNextSmash=26,gameTransitionTime=700,numberX=canvasWidth-60,numberY=80,numberAppearTime=600,numberWaitTime=2e3,numberMoveTime=400,numberBackgroundWidth=380,numberBackgroundHeight=460,startBallGameRotationTime=2e3,startBallGameNoOfTurns=2,menuClothesX=409,menuClothesY=484,menuCakeX=menuClothesX+100+6,menuCakeY=menuClothesY,menuBallX=menuClothesX,menuBallY=menuClothesY+100+6,menuHelpX=menuCakeX,menuHelpY=menuBallY,menuHelpRunningX=10,menuHelpRunningY=25,backButtonX=10,backButtonY=670,ballMinBorderDistance=150,ballMinDistance=100,wrongBallNumberOfTurns=4,wrongBallTurnTime=2e3,tableX=100,tableY=50,clothesGameContainerX=canvasWidth-768,clothesGameContainerY=0,pieceMoveTime=1e3,ballPulsateTime=2e3,characterPulsateTime=1500,cakeBallNoOfTurns=6,clothesTweenTime=600,hitDistance=50,toreX=47,toreY=530,lineX=0,lineY=0,shirtX=592,shirtY=210,shirtWearX=2,shirtWearY=-3,shirtStartRotation=-180,trousersX=167,trousersY=130,trousersWearX=0,trousersWearY=106,trousersStartRotation=-157,sockLeftX=309,sockLeftY=127,sockLeftStartRotation=20,sockLeftWearX=-32,sockLeftWearY=186,sockRightX=425,sockRightY=143,sockRightStartRotation=30,sockRightWearX=28,sockRightWearY=186,ballTween={},allCharacters=[],cardinal=["noll","en","tvaa","tre","fyra","fem","sex"],ordinal=["nolltetaartbiten","foerstataartbiten","andrataartbiten","tredjetaartbiten","fjaerdetaartbiten","femtetaartbiten","sjaettetaartbiten"],generalHelpText="Det finns tre olika spel, tårtspelet, bollspelet och klädspelet. Tårtspelet och bollspelet fungerar bäst om ljudet är på. Peka på knapparna för att välja ett av spelen. ",ballHelpText="Du ska försöka få bort alla bollarna. Lyssna på rösten och peka på bollen med rätt färg. \n\nPeka på pilen för att komma till startsidan där du kan välja ett annat spel. ",clothesHelpText="Dra kläderna från tvättlinan till Tore. Sätt kläderna på rätt ställe på kroppen. När Tore har alla kläder på sig kan du rita på skärmen. Men rita inte på Tore, då blir han ledsen. \n\nPeka på pilen för att komma till startsidan där du kan välja ett annat spel eller börja om det här spelet. ",cakeHelpText="Alla vill ha tårta. Rösten berättar vems tur det är att få tårta. Peka på den personen som vill ha tårta. \n\nPeka på pilen för att komma till startsidan där du kan välja ett annat spel. ",generalHelpSounds=["generalhelp1","generalhelp2","generalhelp3","generalhelp4"],ballHelpSounds=["ballhelp1","ballhelp2","ballhelp3"],clothesHelpSounds=["clotheshelp1","clotheshelp2","clotheshelp3","clotheshelp4","clotheshelp5"],cakeHelpSounds=["cakehelp1","cakehelp2","cakehelp3","cakehelp4"],piecesLeft,menuClothes,boelToreSplash,nextSmashId,nextBallId,randomCheckId,showNumberId,tadaId,helpFrame,helpTextBox,helpContainer,canvas,minBounceDistance,stage,helpBackground,queue,offset,update=!1,menuBall,menuCake,menuHelp,backButton,cakeContainer,progressBar,blueBall,redBall,yellowBall,greenBall,allBalls,allPieces,allSmashedPieces,allCakes,numberOfCakePieces,cakeFilesNew,cakeBall,table,clothesGameContainer,line,shirt,trousers,sockRight,sockLeft,tore,star,tableBoel={},tableMom={},tableGrandDad={},tableDad={},tableTore={},tableDog={},tableTable,numbers=[],numberBackground,debugText,loadedFiles,filesToLoad,nowMillis,nextSmash,nextRandomCheck,pieceNumberToSmash,nextBall,nextBallTime,selectedCharacterIndex,selectedName,soundQueue=[],paintDetect=[],lastWakeTime=0,drawingCanvas,oldPt,oldMidPt,crayonColor,crayonStroke,crayonColors,crayonColorIndex,crayons=[],crayonsOverlay=[],stroke;